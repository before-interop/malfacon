openapi: 3.1.0

info:
  title: Malfacon API
  version: 2.0.0
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
    identifier: Apache-2.0
  description: |
    Cet outil permet la déclaration et le traitement d'une malfaçon grâce à des flux normalisés.

    ## Lexique

    #### OI

    Opérateur d'immeuble:
    Toute personne chargée de l'établissement ou de la gestion d'une ou plusieurs lignes dans un immeuble bâti,
    notamment dans le cadre d'une convention d'installation, d'entretien, de remplacement ou de gestion
    des lignes signée avec le propriétaire ou le syndicat de copropriétaires,
    en application de l'article L. 33-6 du code des postes et des communications électroniques ;
    l'opérateur d'immeuble n'est pas nécessairement un opérateur au sens de l'article L. 33-1 du même code.

    #### OC

    Opérateur Commercial
    Opérateur choisi par le client final pour la fourniture d'un service de télécommunications
    ou par un fournisseur d'accès au service pour la fourniture d'un service de télécommunications
    à son propre client final.

    #### Malfaçon

    Une malfaçon est une non-conformité issue de travaux menés dans le cadre
    d'une prestation de production ou de SAV sur un accès (PM/PBO/PTO),
    confiée à un intervenant selon un cahier des charges (STAS et règles de l'art).

    ## Processus

    1. La signalisation de malfaçons peut être faite par un OI vers OC comme par un OC vers un OI.

    2. Certaines malfaçons sont détectables aussi bien par un OI que par un OC,
        d'autres sont vues comme détectables uniquement par un OI ou uniquement par un OC.

    3. La signalisation de malfaçon par un OI vers un OC est une notification
        appelant action de la part de l'OC destinataire ou informant ce dernier
        d'une malfaçon n'appelant pas action de sa part.

        Cette notification suppose que l'OC pourra intervenir pour traiter la malfaçon:

        * Si les conditions font que c'est impossible et plus particulièrement sur un PM devenu inexploitable,
          alors l'OI doit procéder par une Remise En Conformité (REC)
        * Si l'OC constate lors de son intervention que l'état du PM ne lui permet pas de traiter la malfaçon,
          alors il aura la possibilité de le signaler en retour à l'OI.

    4. La signalisation de malfaçon par un OC vers un OI est une remontée d'information
        qui n'implique pas d'engagement de l'OC sur son niveau de précision:
        cette signalisation constitue une information complémentaire pour l'OI
        dans le cadre de l'exploitation de son réseau.

    5. De par sa définition, la Malfaçon se distingue de la notion de « Dysfonctionnement »
        dont est ici rappelée la définition Interop'Fibre:

            «
              Un dysfonctionnement est une problématique qui rend impossible
              l'adduction du réseau d'un OC au PM mis à disposition par un OI
            »

    6. A noter que les notions de « Dommages »,
        qui peuvent apparaître dans les contrats des OI, ne sont pas normalisées.
        Dans tous les cas, il est important que ces définitions contractuelles
        ne viennent pas recouvrir le périmètre de la Malfaçon.

    ## Types de signalement

    ![Types de signalement](./type.drawio.svg)

    ## Workflow

    ### Cycle de vie d'une Malfaçon Imputable OI vers OC non critique

    ![Cycle de vie d'une Malfaçon Imputable OI vers OC non critique](./statusOiOcImput.drawio.svg)

    ### Cycle de vie d'une Malfaçon Non imputable ou Critique de l'OI vers OC

    ![Cycle de vie d'une Malfaçon Non imputable ou Critique de l'OI vers OC](./statusOiOcNonImputCrit.drawio.svg)

    ### Cycle de vie d'une Malfaçon OC vers OI

    ![Cycle de vie d'une Malfaçon OC vers OI](./statusOcOi.drawio.svg)

    ## Pagination

    Les listes de ressources sont paginées.

    * La valeur par défaut d'une page est `limit=50` et `offset=0`.
    * La valeur maximale de `limit` est `100`.

    ## Dépendances

    Cette API utilise une architecture proxyfié pour la gestion des dépendances.

    ![Proxyfied architecture schema](https://raw.githubusercontent.com/before-interop/common/main/schema/architecture.drawio.svg)

    * [TroubleTicket](https://ggrebert.github.io/before-interop-common/?urls.primaryName=TroubleTicket)
    * [Attachment](https://ggrebert.github.io/before-interop-common/?urls.primaryName=Attachment)
    * [Note](https://ggrebert.github.io/before-interop-common/?urls.primaryName=Note)
    * [Event](https://ggrebert.github.io/before-interop-common/?urls.primaryName=Event)

servers:
  - url: "{protocol}://{host}:{port}{basePath}/malfacon"
    variables:
      protocol:
        enum:
          - https
          - http
        default: https
      host:
        default: localhost
      port:
        default: "8080"
      basePath:
        default: /api

tags:
  - name: TroubleTicket
    description: TroubleTicket management
  - name: Note
    description: Note management
  - name: Attachment
    description: Attachment management
  - name: Event
    description: Event management
  - name: OI
    description: OI endpoints
  - name: OC
    description: OC endpoints

paths:
  /:
    get:
      tags:
        - TroubleTicket
        - OI
      summary: Get all trouble tickets
      description: Get all trouble tickets
      operationId: getTroubleTickets
      parameters: &searchAndPaginateParameters
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/parameters/limit
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/parameters/offset
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/parameters/sort
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/fields.openapi.yaml#/components/parameters/fields
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/filters.openapi.yaml#/components/parameters/filters
      responses:
        "200":
          description: The list of trouble tickets
          headers:
            X-Total-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Total-Count
            X-Result-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Result-Count
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/MalfaconAny"
        "400": &response400
          description: |
            **Bad Request**

            This error occurs when a query parameter or the body is invalid.

            * The `reason` field of the error response can contain information about the error.
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/Error-400
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

    head:
      tags:
        - TroubleTicket
        - OI
      summary: Count the number of trouble tickets
      description: Count the number of trouble tickets matching the given criteria.
      operationId: countTroubleTickets
      parameters:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/filters.openapi.yaml#/components/parameters/filters
      responses:
        "200":
          description: The number of trouble tickets.
          headers:
            X-Total-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Total-Count
        "400": *response400
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Error.openapi.yaml#/components/schemas/Error

    post:
      tags:
        - TroubleTicket
        - OI
      summary: Create a trouble ticket
      description: Create a trouble ticket
      operationId: createTroubleTicket
      requestBody:
        description: The malfacon to create
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MalfaconOiOne"
      responses:
        "201": &troubleTicket201
          description: The created malfacon
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MalfaconOiOne"
          headers:
            ETag:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/update.openapi.yaml#/components/headers/ETag
        "400": *response400
        "403": &response403
          description: |
            **Forbidden**

            Le serveur a compris la requête, mais refuse de l'exécuter car le client n'a pas respecté le processus de création ou de mise à jour.

            Exemple: passage du status `ACKNOWLEDGED` à `RESOLVED` sans passer par le status `IN_PROGRESS`.

            * Le champ `reason` de la réponse d'erreur doit contenir la liste des tickets en conflit séparés par des virgules.
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Error.openapi.yaml#/components/schemas/Error

  /{malfaconId}:
    parameters:
      - $ref: "#/components/parameters/malfaconId"

    get:
      tags:
        - TroubleTicket
        - OI
      summary: Get a trouble ticket
      description: Get a trouble ticket
      operationId: getTroubleTicket
      parameters:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/fields.openapi.yaml#/components/parameters/fields
      responses:
        "200":
          description: The malfacon
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MalfaconOne"
          headers:
            ETag:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/update.openapi.yaml#/components/headers/ETag
        "404": &response404
          description: |
            **Not Found**

            This error occurs when the resource does not exist or is not visible by the user.
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/Error-404
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Error.openapi.yaml#/components/schemas/Error

    put:
      tags:
        - TroubleTicket
        - OI
      summary: Update a trouble ticket
      description: Update a trouble ticket
      operationId: updateTroubleTicket
      requestBody:
        description: The trouble ticket to update
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MalfaconOne"
      parameters:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/update.openapi.yaml#/components/parameters/If-Match
      responses:
        "200": *troubleTicket201
        "400": *response400
        "403": *response403
        "404": *response404
        "412":
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/Error-412
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

    patch:
      tags:
        - TroubleTicket
        - OI
      summary: Partially update a trouble ticket
      description: Partially update a trouble ticket
      operationId: patchTroubleTicket
      requestBody:
        description: The data to update
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/MalfaconOne"
      parameters:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/update.openapi.yaml#/components/parameters/If-Match
      responses:
        "200": *troubleTicket201
        "400": *response400
        "403": *response403
        "404": *response404
        "412":
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/Error-412
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

  /{malfaconId}/note:
    parameters:
      - $ref: "#/components/parameters/malfaconId"

    get:
      tags:
        - Note
        - OI
      summary: Get all notes of a trouble ticket
      description: Get all notes of a trouble ticket
      operationId: getNotes
      parameters: *searchAndPaginateParameters
      responses:
        "200":
          description: The list of notes
          headers:
            X-Total-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Total-Count
            X-Result-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Result-Count
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Note"
        "400": *response400
        "404": *response404
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

    head:
      tags:
        - Note
        - OI
      summary: Count the number of notes of a trouble ticket
      description: Count the number of notes of a trouble ticket matching the given criteria.
      operationId: countNotes
      parameters:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/filters.openapi.yaml#/components/parameters/filters
      responses:
        "200":
          description: The number of notes
          headers:
            X-Total-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Total-Count
        "400": *response400
        "404": *response404
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

    post:
      tags:
        - Note
        - OI
      summary: Create a note
      description: This method allows to create a note.
      operationId: createNote
      requestBody:
        description: The note to create
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Note"
      responses:
        "201":
          description: The created note
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Note"
          headers:
            ETag:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/update.openapi.yaml#/components/headers/ETag
        "400": *response400
        "404": *response404
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

  /{malfaconId}/attachment:
    parameters:
      - $ref: "#/components/parameters/malfaconId"

    get:
      tags:
        - Attachment
        - OI
      summary: List attachments
      description: Get all attachments of a trouble ticket
      operationId: getAttachments
      parameters: *searchAndPaginateParameters
      responses:
        "200":
          description: The list of attachments
          headers:
            X-Total-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Total-Count
            X-Result-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Result-Count
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Attachment"
        "400": *response400
        "404": *response404
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

    head:
      tags:
        - Attachment
        - OI
      summary: Get the number of attachments
      description: This method returns the number of attachments matching the criteria.
      operationId: countAttachments
      parameters:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/filters.openapi.yaml#/components/parameters/filters
      responses:
        "200":
          description: The number of attachments
          headers:
            X-Total-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Total-Count
        "400": *response400
        "404": *response404
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

    post:
      tags:
        - Attachment
        - OI
      summary: Create a attachment
      description: This method allows to create a attachment.
      operationId: createAttachment
      requestBody:
        description: The attachment to create
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/AttachmentFormData"
      responses:
        "201":
          description: The created attachment
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Attachment"
          headers:
            ETag:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/update.openapi.yaml#/components/headers/ETag
        "400": *response400
        "404": *response404
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

  /{malfaconId}/attachment/{attachmentId}/content:
    parameters:
      - $ref: "#/components/parameters/malfaconId"
      - $ref: "#/components/parameters/attachmentId"

    get:
      tags:
        - Attachment
        - OI
      summary: Download the content of an attachment
      description: This method allows to download the content of an attachment.
      operationId: downloadAttachment
      parameters:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/tools/attachment/attachment.openapi.yaml#/components/parameters/If-Match
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/tools/attachment/attachment.openapi.yaml#/components/parameters/If-None-Match
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/tools/attachment/attachment.openapi.yaml#/components/parameters/If-Modified-Since
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/tools/attachment/attachment.openapi.yaml#/components/parameters/If-Unmodified-Since
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/tools/attachment/attachment.openapi.yaml#/components/parameters/Range
      responses:
        "200":
          description: The content of the attachment
          content:
            application/octet-stream: {}
        "404": *response404
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default
        "412":
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/Error-412

  /event:
    get:
      tags:
        - Event
        - OI
      summary: Get all events of all trouble tickets
      description: Get all events of all trouble tickets
      parameters: *searchAndPaginateParameters
      responses:
        "200":
          description: The list of events
          headers:
            X-Total-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Total-Count
            X-Result-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Result-Count
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Event"
        "400": *response400
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

    head:
      tags:
        - Event
        - OI
      summary: Count the number of events of all trouble tickets
      description: Count the number of events of all trouble tickets matching the given criteria.
      parameters:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/filters.openapi.yaml#/components/parameters/filters
      responses:
        "200":
          description: The number of events
          headers:
            X-Total-Count:
              $ref: https://raw.githubusercontent.com/before-interop/common/main/common/utils/paginate.openapi.yaml#/components/headers/X-Total-Count
        "400": *response400
        default:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/responses/errors.openapi.yaml#/components/responses/default

    post:
      tags:
        - Event
        - OC
      summary: Receive an event for a trouble ticket
      description: Receive an event for a trouble ticket
      requestBody:
        description: The event to receive
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Event"
      responses:
        default:
          description: |
            L'événement a été reçu avec succès.

            La réponse n'a pas l'obligation de contenir un body.
            Si l'OC retourne un body, celui-ci pourra être enregistré dans le journal de l'OI.
        4xx:
          description: |
            Erreur lors de la réception de l'événement.

            L'OI ne doit pas retransmettre l'événement à l'OC.

            La réponse n'a pas l'obligation de contenir un body.
            Si l'OC retourne un body, celui-ci pourra être enregistré dans le journal de l'OI.
        5xx:
          description: |
            Erreur lors de la réception de l'événement.

            L'OI peut retransmettre l'événement à l'OC.

            La réponse n'a pas l'obligation de contenir un body.
            Si l'OC retourne un body, celui-ci pourra être enregistré dans le journal de l'OI.

components:
  schemas:
    MalfaconAny:
      anyOf:
        - $ref: "#/components/schemas/MalfaconOiAny"
        - $ref: "#/components/schemas/MalfaconOcAny"

    MalfaconOne:
      anyOf:
        - $ref: "#/components/schemas/MalfaconOiOne"
        - $ref: "#/components/schemas/MalfaconOcOne"

    MalfaconOiAny:
      anyOf:
        - $ref: "#/components/schemas/MalfaconOiPm"
        - $ref: "#/components/schemas/MalfaconOiAmontPm"
        - $ref: "#/components/schemas/MalfaconOiPmPbo"
        - $ref: "#/components/schemas/MalfaconOiPbo"
        - $ref: "#/components/schemas/MalfaconOiCcfCable"
        - $ref: "#/components/schemas/MalfaconOiCcfPto"

    MalfaconOiOne:
      oneOf:
        - $ref: "#/components/schemas/MalfaconOiPm"
        - $ref: "#/components/schemas/MalfaconOiAmontPm"
        - $ref: "#/components/schemas/MalfaconOiPmPbo"
        - $ref: "#/components/schemas/MalfaconOiPbo"
        - $ref: "#/components/schemas/MalfaconOiCcfCable"
        - $ref: "#/components/schemas/MalfaconOiCcfPto"

    MalfaconOcAny:
      anyOf:
        - $ref: "#/components/schemas/MalfaconOcPm"
        - $ref: "#/components/schemas/MalfaconOcAmontPm"
        - $ref: "#/components/schemas/MalfaconOcPmPbo"
        - $ref: "#/components/schemas/MalfaconOcPbo"
        - $ref: "#/components/schemas/MalfaconOcCcfCable"
        - $ref: "#/components/schemas/MalfaconOcCcfPto"

    MalfaconOcOne:
      oneOf:
        - $ref: "#/components/schemas/MalfaconOcPm"
        - $ref: "#/components/schemas/MalfaconOcAmontPm"
        - $ref: "#/components/schemas/MalfaconOcPmPbo"
        - $ref: "#/components/schemas/MalfaconOcPbo"
        - $ref: "#/components/schemas/MalfaconOcCcfCable"
        - $ref: "#/components/schemas/MalfaconOcCcfPto"

    MalfaconBase:
      allOf:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/TroubleTicket.openapi.yaml#/components/schemas/TroubleTicket
      required:
        - codeOi
        - codeOc
        - referenceSignalisationOi
        - "@type"
        - severity
        - status
        - statusChangeReason
        - lastUpdateDate
        - creationDate
      properties:
        codeOi:
          description: Code(s) OI référence Interop
          type: array
          items:
            type: string
        codeOc:
          description: Code(s) OC référence Interop
          type: array
          items:
            type: string
        referenceSignalisationOi:
          description: Référence du ticket créé dans le système de l'OI
          type: string
        referenceSignalisationOc:
          description: Référence du ticket créé dans le système de l'OC
          type: string
        "@type":
          default: Malfacon
          example: Malfacon
          readOnly: false
        "@baseType":
          default: Malfacon
          example: Malfacon
          enum:
            - Malfacon
        severity:
          description: |
            The severity of the malfacon

            Allowed values are:

            * `CRITICAL`

              Si la malfaçon représente un danger grave est imminent pour les personnes,
              l'OI se réserve le droit d'effectuer la reprise ou à minima sécurise les lieux
              et demande à l'OC d'intervenir.

              De son côté, l'OC se doit de signaler à l'OI toute malfaçon
              représentant un danger grave et imminent pour les personnes.

            * `MAJOR`

              La malfaçon signifie une détérioration du site technique ou un risque d'intéruption
              massive de service (dérangement collectif) ou un empêchement à produire
              de nouveaux client (depuis le passage de commande jusqu'au raccordement).

              Exemples:

              * défaut d'étanchéité sur PB
              * PM ouvert
              * site insalubre
              * brassage encombrant
              * données de localisation erronées

            * `MINOR`

              Les autres non conformités à corriger.
          enum:
            - CRITICAL
            - MAJOR
            - MINOR
        status:
          enum:
            - ACKNOWLEDGED
            - CANCELLED
            - CLOSED
            - CREATING
            - HELD
            - IN_PROGRESS
            - PENDING
            - REJECTED
            - RESOLVED
        statusChangeReason:
          enum:
            - ACKNOWLEDGED
            - CHARGEABLE_ACCEPTED
            - CONTESTATION
            - CREATING
            - CRITICAL_IN_PROGRESS
            - DEFECT_CHARGEABLE
            - DEFECT_COMMUNICATED_BY_OC
            - DEFECT_UNCHARGEABLE
            - DELAY_ANSWER_EXPIRED
            - DELAY_VALIDATION_EXPIRED
            - DUPLICATE
            - INFORMATION_GIVEN
            - INVALID
            - LACK_OF_INFORMATION
            - NON_CHARGEABLE_IN_PROGRESS
            - ORDER_PUT_INTO_SERVICE_FOR_MORE_THAN_A_YEAR
            - OTHER
            - PARTIALLY_RESOLVED
            - PHOTO_NOT_USABLE
            - PM_ERROR
            - REC_CANDIDATE
            - RESOLUTION_ACCEPTED
            - RESOLUTION_DATE_EXPIRED
            - RESOLUTION_REFUSED
            - RESOLVED_OC
            - RESOLVED_OI
            - UNKNOWN_RESSOURCE
            - UNRESOLVED_TICKET
            - WRONG_TICKET
            - DELAY_RESOLUTION_OI_EXPIRED

    MalfaconOcBase:
      allOf:
        - $ref: "#/components/schemas/MalfaconBase"
      required:
        - volumetry
        - localisationDetails
        - codeFault
      properties:
        volumetry:
          description: The volumetry of the malfacon
          type: integer
          example: 1
        localisationDetails:
          type: string
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          type: string

    MalfaconOiBase:
      allOf:
        - $ref: "#/components/schemas/MalfaconBase"
      required:
        - volumetry
        - localisationDetails
        - codeFault
        - chargeable
        - ocNumber
        - resolutionOwner
      properties:
        volumetry:
          description: The volumetry of the malfacon
          type: integer
          example: 1
        localisationDetails:
          type: string
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          type: string
        chargeable:
          type: boolean
        ocNumber:
          type: number
        resolutionOwner:
          type: string
        totalResolutionOcDuration:
          description: The OC resolution duration. Calculated only as long as ResolutionOwner = OC
          type: number
        expectedResolutionDate:
          descritpion: The maximum OC resolution date, recalculated only during state changes taking into account the ticket creation date and successive pauses.
          type: string
          format: date
        validationDueDate:
          description: The deadline for validation status
          type: string
          format: date
        pendingDueDate:
          description: The deadline for pending status
          type: string
          format: date

    MalfaconOiPm:
      allOf:
        - $ref: "#/components/schemas/MalfaconOiBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pm
      properties:
        "@type":
          example: Pm
          enum:
            - Pm
        localisationDetails:
          enum:
            - TIROIR ZAPM
            - CONNECTEUR TIROIR ZAPM
            - BRASSAGE OC
            - TIROIR OC
            - ARMOIRE
            - ROUTE OPTIQUE
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD06
            - FD09
            - FD12
            - FD14
            - FD17
            - FD18
            - FD19
            - FD20
            - FD21
            - FD22
            - FD26
            - FD31
            - FD36
            - FD41
            - FD42
        pm:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PM

    MalfaconOiAmontPm:
      allOf:
        - $ref: "#/components/schemas/MalfaconOiBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pm
      properties:
        "@type":
          example: AmontPm
          enum:
            - AmontPM
        localisationDetails:
          enum:
            - COLLECTE LIEN PM-PRDM
            - ADDUCTION OC
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD06
            - FD08
            - FD11
            - FD27
        pm:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PM

    MalfaconOiPmPbo:
      allOf:
        - $ref: "#/components/schemas/MalfaconOiBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pm
        - pbo
      properties:
        "@type":
          example: PmPbo
          enum:
            - PmPbo
        localisationDetails:
          enum:
            - PM-PBO INSTALLATION
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD01
            - FD15
        pm:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PM
        pbo:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PBO

    MalfaconOiPbo:
      allOf:
        - $ref: "#/components/schemas/MalfaconOiBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pbo
      properties:
        "@type":
          example: Pbo
          enum:
            - Pbo
        localisationDetails:
          enum:
            - CASSETTE
            - BOITIER
            - PBO ENVIRONNEMENT
            - ROUTE OPTIQUE
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD04
            - FD05
            - FD15
            - FD16
            - FD23
            - FD29
            - FD30
            - FD34
            - FD36
            - FD44
            - FD46
            - FD47
        pbo:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PBO

    MalfaconOiCcfCable:
      allOf:
        - $ref: "#/components/schemas/MalfaconOiBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pbo
        - pto
      properties:
        "@type":
          example: CcfCable
          enum:
            - CcfCable
        localisationDetails:
          enum:
            - CABLE CARACTERISTIQUE
            - CABLE INSTALLATION
            - ENTREE DE CABLE PBO
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD02
            - FD03
            - FD13
            - FD37
            - FD38
        refOrder:
          description: Référence de la commande
          type: string
        localisation:
          description: Localisation GPS du câble
          $ref: "#/components/schemas/localisation"
        pbo:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PBO
        pto:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PTO

    MalfaconOiCcfPto:
      allOf:
        - $ref: "#/components/schemas/MalfaconOiBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pto
      properties:
        "@type":
          example: CcfPto
          enum:
            - CcfPto
        localisationDetails:
          enum:
            - PTO CARACTERISTIQUE
            - PTO INSTALLATION
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD10
            - FD40
            - FD43
        localisation:
          description: Localisation GPS de la PTO
          $ref: "#/components/schemas/localisation"
        pto:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PTO

    MalfaconOcPm:
      allOf:
        - $ref: "#/components/schemas/MalfaconOcBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pm
      properties:
        "@type":
          example: Pm
          enum:
            - Pm
        localisationDetails:
          enum:
            - TIROIR ZAPM
            - CONNECTEUR TIROIR ZAPM
            - BRASSAGE OC
            - ARMOIRE
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD06
            - FD07
            - FD14
            - FD18
            - FD19
            - FD20
            - FD21
            - FD22
            - FD24
            - FD31
            - FD42
        pm:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PM

    MalfaconOcAmontPm:
      allOf:
        - $ref: "#/components/schemas/MalfaconOcBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pm
      properties:
        "@type":
          example: AmontPm
          enum:
            - AmontPM
        localisationDetails:
          enum:
            - COLLECTE LIEN PM-PRDM
            - ADDUCTION OC
            - AMONT PM INSTALLATION
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD06
            - FD11
            - FD27
            - FD39
            - FD48
        pm:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PM

    MalfaconOcPmPbo:
      allOf:
        - $ref: "#/components/schemas/MalfaconOcBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pm
        - pbo
      properties:
        "@type":
          example: PmPbo
          enum:
            - PmPbo
        localisationDetails:
          enum:
            - PM-PBO INSTALLATION
        codeFault:
          enum:
            - FD01
            - FD15
        pm:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PM
        pbo:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PBO

    MalfaconOcPbo:
      allOf:
        - $ref: "#/components/schemas/MalfaconOcBase"
      properties:
        "@type":
          example: Pbo
          enum:
            - Pbo
        localisationDetails:
          enum:
            - CASSETTE
            - BOITIER
            - PBO ENVIRONNEMENT
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD04
            - FD15
            - FD16
            - FD28
            - FD29
            - FD30
            - FD34
        pbo:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PBO

    MalfaconOcCcfCable:
      allOf:
        - $ref: "#/components/schemas/MalfaconOcBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pbo
        - pto
      properties:
        "@type":
          example: CcfCable
          enum:
            - CcfCable
        localisationDetails:
          enum:
            - CABLE CARACTERISTIQUE
            - CABLE INSTALLATION
            - ENTREE DE CABLE PBO
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD02
            - FD03
            - FD10
            - FD13
            - FD15
            - FD25
            - FD34
            - FD35
            - FD37
            - FD38
            - FD45
            - FD49
        refOrder:
          description: Référence de la commande
          type: string
        localisation:
          description: Localisation GPS du câble
          $ref: "#/components/schemas/localisation"
        pbo:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PBO
        pto:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PTO

    MalfaconOcCcfPto:
      allOf:
        - $ref: "#/components/schemas/MalfaconOcBase"
      required:
        - "@type"
        - localisationDetails
        - codeFault
        - pto
      properties:
        "@type":
          example: CcfPto
          enum:
            - CcfPto
        localisationDetails:
          enum:
            - PTO CARACTERISTIQUE
            - PTO INSTALLATION
        codeFault:
          description: |
            Correspondances des codeFault :
            | Code                             | valeur                                |
            | ------------------------------------ | -------------------------------------- |
            | FD01 | ABSENCE_DE_GAINE_DEMI-LUNE_POUR_PROTEGER_CABLE_PBO_AERIEN_POTEAU_OU_FACADE_DEGRADATION |
            | FD02 | ABSENCE_PROTECTION_OBLIGATOIRE_GAINE_FENDUE_DEMI LUNE |
            | FD03 | BILAN_OPTIQUE_NON_CONFORME_AUX_STAS |
            | FD04 | BOITIER_PBO_NON_MAL_ETIQUETE_HORS_ECHEC_DE_PRODUCTION |
            | FD05 | BOITIER_PBO_NON_MAL_REFERME_NON_MAL_REFIXE |
            | FD06 | BOUCHON_ABSENT |
            | FD07 | BRASSAGE_EXISTANT_ENCOMBRANT_LE_CHEMINEMENT |
            | FD08 | BRASSAGE_OC_NON_CONFORME |
            | FD09 | CARACTERISTIQUE_TIROIR_NON_CONFORME_AUX_STAS |
            | FD10 | CARACTERISTIQUES_NON_CONFORMES_AUX_STAS |
            | FD11 | CHEMINEMENT_CABLE_OC_OI_NON_CONFORME |
            | FD12 | CHEMINEMENT_NON_CONFORME_AUX_STAS |
            | FD13 | CHEMINEMENT_NON_CONFORME_SURPLOMB_DOMAINE PRIVE |
            | FD14 | CORDON_NON_CONFORME_AUX_STAS_CARACTERISTIQUES_TECHNIQUES |
            | FD15 | DEGRADATION |
            | FD16 | DEGRADATION_DU_SUPPORT_PBO_POTEAU |
            | FD17 | DEGRADATION_MAJEURE |
            | FD18 | DEGRADATION_PORTE |
            | FD19 | DEGRADATION_SERRURE |
            | FD20 | DEGRADATION_TAMBOURS |
            | FD21 | DEGRADATION_TIROIRS_CASSES |
            | FD22 | ENVIRONNEMENT_NETTOYAGE_DECHETS_FERMETURE |
            | FD23 | EPISSURE_NON_CONFORME_DENUDAGE_PROTECTION_DE_SOUDURE |
            | FD24 | ETIQUETAGE_DU_PM_NON_CONFORME_HORS_ECHEC_DE_PRODUCTION |
            | FD25 | ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD26 | IMPLANTATION_OU_ETIQUETAGE_NON_CONFORME_AUX_STAS |
            | FD27 | IMPLANTATION_TIROIR_OC_OI_OU_ETIQUETAGE_NON_CONFORME |
            | FD28 | LOCALISATION_NON_CONFORME_AUX_DONNEES_OI_COMMANDE_ACCES_HORS_ECHEC_DE_PRODUCTION |
            | FD29 | LOVAGE_FIBRE_NON_CONFORME_AUX_STAS |
            | FD30 | LOVAGE_CABLE_EN_CHAMBRE_OU_POTEAU_NON_CONFORME_AUX_STAS |
            | FD31 | MAUVAISE_FIXATION |
            | FD32 | MAUVAISE_FIXATION_OU_FERMETURE_DEGRADEE |
            | FD33 | MODULARITE_DU_CABLE_CCF_NON_CONFORME |
            | FD34 | NETTOYAGE_CHANTIER |
            | FD35 | NON_CONFORME_AUX_STAS |
            | FD36 | NON_RESPECT_ROUTE_OPTIQUE_COMMUNIQUEE |
            | FD37 | NON_UTILISABLE_PAS_DAUTORISATION_DE_CHEMINEMENT |
            | FD38 | NON_UTILISABLE_RISQUE_DE_SURPLOMB_SECURISE |
            | FD39 | PASSAGE_DE_CABLE_NON_CONFORME |
            | FD40 | POSE_NON_CONFORME_IMPLANTATION_OU_FIXATION |
            | FD41 | PRESENCE_DE_CORDONS_A_ZERO_NON_RETIRES |
            | FD42 | PRESENCE_DE_CORDONS_NON_CONFORMES |
            | FD43 | PTO_MAL_OU_NON_ETIQUETEE |
            | FD44 | RACCORDEMENT_DE_SITE_NON_DEPLOYE_DANS_IPE |
            | FD45 | REBOUCHAGE_NON_EFFECTUE |
            | FD46 | REPRISE_SAUVAGE_ROUTE_OPTIQUE_PAR_CASSE_SOUDURE_AU_PBO |
            | FD47 | TAILLE_SMOOVE_NON_CONFORME |
            | FD48 | TIROIR_OI_DEGRADE |
            | FD49 | TYPE_DE_POSE_FIXATION_NON_CONFORME_AUX_PRECONISATIONS_OI |
          enum:
            - FD10
            - FD40
            - FD43
        localisation:
          description: Localisation GPS de la PTO
          $ref: "#/components/schemas/localisation"
        pto:
          $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Interop.openapi.yaml#/components/schemas/PTO

    localisation:
      type: object
      properties:
        latitude:
          description: The latitude
          type: number
          example: 48.8566
        longitude:
          description: The longitude
          type: number
          example: 2.3522

    Attachment:
      allOf:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Attachment.openapi.yaml#/components/schemas/Attachment
      description: |
        An attachment is a file that is attached to an entity.

        Only JPEG images are allowed.

        Extensions:

        * `.jpg`
        * `.jpeg`

        Mime types:

        * `image/jpeg`
      properties:
        mimeType:
          enum:
            - image/jpeg
        status:
          enum:
            - PENDING
            - VALIDATED
            - REJECTED
        relatedEntity:
          description: Reference to the malfacon
          minItems: 1
          maxItems: 1

    AttachmentFormData:
      allOf:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/tools/attachment/attachment.openapi.yaml#/components/schemas/AttachmentFormData
      properties:
        attachment:
          $ref: "#/components/schemas/Attachment"

    Note:
      allOf:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/Note.openapi.yaml#/components/schemas/Note
      properties:
        relatedEntity:
          description: Reference to the malfacon
          minItems: 1
          maxItems: 1

    Event:
      allOf:
        - $ref: https://raw.githubusercontent.com/before-interop/common/main/common/schemas/CloudEvent.openapi.yaml#/components/schemas/CloudEvent
      required:
        - time
        - subject
      properties:
        subject:
          description: Identifiant unique de la malfaçon.
          type: string
          format: uuid
        type:
          enum:
            - fr.interop.malfacon.create
            - fr.interop.malfacon.update
            - fr.interop.malfacon.note.create
            - fr.interop.malfacon.attachment.create
            - fr.interop.malfacon.attachment.update
        datacontenttype:
          const: application/json
        data:
          oneOf:
            - $ref: "#/components/schemas/MalfaconOne"
            - $ref: "#/components/schemas/Note"
            - $ref: "#/components/schemas/Attachment"

  parameters:
    malfaconId:
      name: malfaconId
      in: path
      description: The malfacon id
      required: true
      schema:
        type: string

    attachmentId:
      name: attachmentId
      in: path
      description: The attachment id
      required: true
      schema:
        type: string
